<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:models="clr-namespace:DbPad.Models"
        x:Class="DbPad.Views.MainWindow"
        Width="800" Height="600"
        Title="DbPad"
        xmlns:vm="using:DbPad.ViewModels"
        x:DataType="vm:MainWindowViewModel"
		>
	<!-- Main content below toolbar -->
	<Grid ColumnDefinitions="275,Auto,*">
		<Grid.RowDefinitions>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>


		<!-- left side -->
		<Grid  Grid.Column="0" Margin="8">
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="*"/>
			</Grid.RowDefinitions>
			<Border HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="Gray" BorderThickness="">
				<WrapPanel  MinHeight="50">
					<Button Content="+ Connection" Margin="5,0,0,0" Command="{Binding AddConnectionCommand}"/>
					<Button Content="- Connection" Margin="5,0,0,0"/>
					<Button Content="Edit Connection" Margin="5,0,0,0"/>
					<Button Content="Add Tab" Margin="5,0,0,0" Command="{Binding AddTabCommand}"/>
				</WrapPanel>
			</Border>
			
			<TreeView Grid.Row="1" ItemsSource="{Binding Nodes}">
				<TreeView.ItemTemplate>
					<TreeDataTemplate ItemsSource="{Binding SubNodes}">
						<TextBlock Text="{Binding Title}">
							<TextBlock.ContextMenu>
								<ContextMenu DataContext="{Binding $parent[TreeView].DataContext}">
									<MenuItem Header="Select * 1000"
											  Command="{Binding Select1000Command}"
											  CommandParameter="{Binding $parent[TreeView].SelectedItem}" />
									<MenuItem Header="Edit Table"
											  Command="{Binding EditDataCommand}"
											  CommandParameter="{Binding $parent[TreeView].SelectedItem}" />
								</ContextMenu>
							</TextBlock.ContextMenu>
						</TextBlock>
					</TreeDataTemplate>
				</TreeView.ItemTemplate>
			</TreeView>
		</Grid>

		<GridSplitter Grid.Column="1"
							Width="5"
							Background="DarkGray"
							ResizeDirection="Columns"
							ResizeBehavior="PreviousAndNext"
							HorizontalAlignment="Stretch"/>

		<!-- Right side: vertical split for input and output -->
		<Grid Grid.Column="2" Margin="8">
			<Grid.RowDefinitions>
				<RowDefinition Height="*"/>
			</Grid.RowDefinitions>

			<StackPanel>
				<TabControl ItemsSource="{Binding Tabs}" SelectedItem="{Binding SelectedTab}">
					<TabControl.ItemTemplate>
						<DataTemplate>
							<TextBlock Text="{Binding TabCaption, FallbackValue=Tab}" />
						</DataTemplate>
					</TabControl.ItemTemplate>
					<TabControl.ContentTemplate>
						<DataTemplate x:DataType="vm:TabItemModel">
							<Grid>
								<Grid.RowDefinitions>
									<RowDefinition/>
									<RowDefinition Height="100"/>
									<RowDefinition Height="100"/>
									<RowDefinition Height="*"/>
								</Grid.RowDefinitions>
								<StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,0">
									<Button Content="Execute" Command="{Binding ExecuteSQLCommand}"/>
								</StackPanel>
								<TextBox Grid.Row="1" Text="{Binding Query, Mode=TwoWay}" AcceptsReturn="True"/>
								<TextBox Grid.Row="2" Text="{Binding Results, Mode=TwoWay}" Watermark="Text 2"/>
								<DataGrid Grid.Row="3" ItemsSource="{Binding ResultsView}" AutoGenerateColumns="True"/>
							</Grid>
						</DataTemplate>
					</TabControl.ContentTemplate>
				</TabControl>
			</StackPanel>
		</Grid>
	</Grid>


</Window>
