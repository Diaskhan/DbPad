<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:models="clr-namespace:DbPad.Models"
        x:Class="DbPad.Views.MainWindow"
        Width="800" Height="600"
        Title="DbPad"
        xmlns:vm="using:DbPad.ViewModels"
        x:DataType="vm:MainWindowViewModel"
		xmlns:extension="clr-namespace:DbPad.Extensions"
		xmlns:i="using:Avalonia.Xaml.Interactivity"
        xmlns:ic="using:Avalonia.Xaml.Interactions.Core"
		xmlns:common="clr-namespace:DbPad.Common.Models"
		xmlns:view="clr-namespace:DbPad.Views"
		>
	<!-- Main content below toolbar -->
	<Grid ColumnDefinitions="275,Auto,*">
		<Grid.RowDefinitions>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>


		<!-- left side -->
		<Grid  Grid.Column="0">
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="*"/>
			</Grid.RowDefinitions>
			<Border HorizontalAlignment="Left" VerticalAlignment="Top" BorderBrush="Gray" BorderThickness="">
				<WrapPanel  MinHeight="50">
					<Button Content="+ Connection" Margin="5,0,0,0" Command="{Binding AddConnectionCommand}"/>
					<Button Content="- Connection" Margin="5,0,0,0" Command="{Binding RemoveConnectionCommand}"/>
					<Button Content="Edit Connection" Margin="5,0,0,0"/>
					<Button Content="New Query" Margin="5,0,0,0" Command="{Binding NewQueryCommand}"/>
				</WrapPanel>
			</Border>

			<TreeView Grid.Row="1" ItemsSource="{Binding Nodes}" SelectedItem="{Binding SelectedNode}">
				<TreeView.ItemTemplate>
					<TreeDataTemplate ItemsSource="{Binding SubNodes}">
						<!-- Указываем DataType для TreeDataTemplate -->
						<!-- Измененный шаблон: StackPanel для иконки и текста -->
						<StackPanel Orientation="Horizontal" Spacing="5">
							<Image Source="{Binding IconSource, Converter={StaticResource StringToImageConverter}}" Width="16" Height="16"/>
							<TextBlock Text="{Binding Title}" VerticalAlignment="Center">
								<i:Interaction.Behaviors>
									<ic:EventTriggerBehavior EventName="DoubleTapped">
										<ic:InvokeCommandAction Command="{Binding $parent[TreeView].DataContext.ConnectCommand}"
																CommandParameter="{Binding }" />
									</ic:EventTriggerBehavior>
								</i:Interaction.Behaviors>
								<TextBlock.ContextMenu>
									<ContextMenu DataContext="{Binding $parent[TreeView].DataContext}">
										<MenuItem Header="Select * 1000"
												  Command="{Binding Select1000Command}"
												  CommandParameter="{Binding $parent[TreeView].SelectedItem}" />
										<MenuItem Header="Edit Table"
												  Command="{Binding EditDataCommand}"
												  CommandParameter="{Binding $parent[TreeView].SelectedItem}" />
									</ContextMenu>
								</TextBlock.ContextMenu>
							</TextBlock>
						</StackPanel>
					</TreeDataTemplate>
				</TreeView.ItemTemplate>
			</TreeView>
		</Grid>

		<GridSplitter Grid.Column="1"
							Width="1"
							Background="DarkGray"
							ResizeDirection="Columns"
							ResizeBehavior="PreviousAndNext"
							HorizontalAlignment="Stretch"/>

		<!-- Right side: vertical split for input and output -->
		<Grid Grid.Column="2" >
			<view:TabControlView Grid.Column="2"/>
		</Grid>
	</Grid>


</Window>
